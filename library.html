<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://use.typekit.net/oov2wcw.css">
    <title>Document</title>
    <style>
        body {
            margin: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: century-gothic, sans-serif;

        }

        h1 {
            color: white;
        }

        .background-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            z-index: -1;
            width: 100%;
            height: 100%;
            background-image: url(https://images.nypl.org/index.php?id=1632226&t=w);
            background-size: cover;
            background-position: center;
            filter: contrast(45%);
        }

        table {
            margin-bottom: 50px;
            border-collapse: collapse;

        }

        button:hover {
            cursor: pointer;
        }

        td,
        th {
            border: 1px solid black;
            padding: 1rem 1.8rem;

        }

        th {
            background-color: rgb(93, 89, 78);
            ;
            color: rgb(255, 255, 255);
        }

        #new-book {
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            background-color: rgb(93, 89, 78);
            color: white;
            font-size: 16px;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: auto;
        }

        .label-input {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            gap: 30px;
        }

        .dialog-content {
            width: 300px;
            padding: 0px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;

        }

        #buttons {
            display: flex;
            flex-direction: row;
            gap: 10px;
        }

        dialog button {
            padding: 10px;
            width: 100px;
            margin: 20px 0;
            color: white;
            border: none;
            border-radius: 8px;
        }

        dialog::backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            /* dark, semi-transparent */
        }

        #submit-button {
            background-color: green;
        }

        #close-button {
            border: none;
            background-color: red;
        }

        input,
        select {
            width: 175px;
            padding: 3px;
            font-size: 16px;
            box-sizing: border-box;

        }
    </style>
</head>

<body>
    <div class="background-wrapper"></div>
    <h1>My Library</h1>
    <table>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Author</th>
            <th>Pages</th>
            <th>Read</th>
            <th>Actions</th>
        </tr>
    </table>

    <dialog>
        <div class="dialog-content">
            <h2>Book Details</h2>

            <form action id="form" method="post">
                <div class="label-input">
                    <label for="title">Book Title</label>
                    <input type="text" id="title" name="title">
                </div>
                <div class="label-input">
                    <label for="author">Author</label>
                    <input type="text" id="author" name="author">
                </div>
                <div class="label-input">
                    <label for="pages">Pages</label>
                    <input type="number" id="pages" name="pages">
                </div>
                <div class="label-input">
                    <label for="read">Read</label>
                    <select id="read" name="read">
                        <option value="read">Read</option>
                        <option value="not read yet">Not Read Yet</option>
                    </select>
                </div>
            </form>
            <div id="buttons">
                <button type="submit" id="submit-button">Submit</button>
                <button autofocus id="close-button">Close</button>
            </div>
        </div>
    </dialog>
    <button id="new-book">New Book</button>

    <script>
        class Book {
            constructor(title, author, pages, read) {
                this.id = crypto.randomUUID();
                this.title = title;
                this.author = author;
                this.pages = pages;
                this.read = read;
            }

            toggleReadStatus() {
                this.read = this.read === "read" ? "not read yet" : "read";
            }
        }

        class Library {
            constructor() {
                this.books = [];
                this.editingIndex = null;
                this.table = document.querySelector("table");
                this.dialog = document.querySelector("dialog");
                this.showButton = document.querySelector("dialog + button");
                this.closeButton = document.querySelector("#close-button");
                this.submitButton = document.querySelector("#submit-button");

                this.initialize();
            }

            initialize() {
                this.showButton.addEventListener("click", () => this.dialog.showModal());
                this.closeButton.addEventListener("click", () => this.dialog.close());
                this.submitButton.addEventListener("click", (e) => this.handleSubmit(e));

                this.renderEmptyMessage();
            }

            renderEmptyMessage() {
                const row = document.createElement("tr");
                const cell = document.createElement("td");
                cell.setAttribute("colspan", "6");
                cell.textContent = "There are no books to show yet...";
                Object.assign(cell.style, {
                    textAlign: "center",
                    fontStyle: "italic",
                    backgroundColor: "beige",
                });
                row.appendChild(cell);
                this.table.appendChild(row);
            }

            addBook(book) {
                this.books.push(book);
                this.refreshTable();
            }

            editBook(index, updatedData) {
                const book = this.books[index];
                book.title = updatedData.title;
                book.author = updatedData.author;
                book.pages = updatedData.pages;
                book.read = updatedData.read;
                this.refreshTable();
            }

            deleteBook(bookId) {
                this.books = this.books.filter(book => book.id !== bookId);
                this.refreshTable();
            }

            handleSubmit(event) {
                event.preventDefault();
                const title = document.querySelector("#title").value;
                const author = document.querySelector("#author").value;
                const pages = document.querySelector("#pages").value;
                const read = document.querySelector("#read").value;

                if (this.editingIndex === null) {
                    this.addBook(new Book(title, author, pages, read));
                } else {
                    this.editBook(this.editingIndex, { title, author, pages, read });
                    this.editingIndex = null;
                }

                document.querySelector("#form").reset();
                this.dialog.close();
            }

            refreshTable() {
                while (this.table.childElementCount > 1) {
                    this.table.removeChild(this.table.lastElementChild);
                }
                this.books.forEach((book, i) => this.renderBookRow(book, i));
            }

            renderBookRow(book, index) {
                const row = document.createElement("tr");

                row.innerHTML = `
            <td>${book.id}</td>
            <td>${book.title}</td>
            <td>${book.author}</td>
            <td>${book.pages}</td>
        `;

                // Read Button
                const readCell = document.createElement("td");
                const readButton = document.createElement("button");
                readButton.textContent = book.read;
                this.styleButton(readButton);
                readButton.style.backgroundColor = book.read === "read" ? "green" : "grey";
                readButton.addEventListener("click", () => {
                    book.toggleReadStatus();
                    readButton.textContent = book.read;
                    readButton.style.backgroundColor = book.read === "read" ? "green" : "grey";
                });
                readCell.appendChild(readButton);
                row.appendChild(readCell);

                // Actions
                const actionsCell = document.createElement("td");
                const container = document.createElement("div");
                container.style.display = "flex";
                container.style.gap = "20px";

                const editButton = document.createElement("button");
                const deleteButton = document.createElement("button");

                editButton.textContent = "Edit";
                deleteButton.textContent = "Delete";

                this.styleButton(editButton);
                this.styleButton(deleteButton);

                editButton.style.backgroundColor = "blue";
                deleteButton.style.backgroundColor = "red";

                editButton.addEventListener("click", () => {
                    this.editingIndex = index;
                    document.querySelector("#title").value = book.title;
                    document.querySelector("#author").value = book.author;
                    document.querySelector("#pages").value = book.pages;
                    document.querySelector("#read").value = book.read;
                    this.dialog.showModal();
                });

                deleteButton.addEventListener("click", () => {
                    this.deleteBook(book.id);
                });

                container.appendChild(editButton);
                container.appendChild(deleteButton);
                actionsCell.appendChild(container);
                row.appendChild(actionsCell);

                row.style.backgroundColor = "beige";
                this.table.appendChild(row);
            }

            styleButton(button) {
                Object.assign(button.style, {
                    color: "white",
                    border: "none",
                    padding: "8px 20px",
                    borderRadius: "8px",
                });
            }
        }

        // ðŸŽ® Start the library app
        new Library();
    </script>

</body>

</html>